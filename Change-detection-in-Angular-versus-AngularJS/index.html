<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head><meta name="generator" content="Hexo 3.8.0">

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="Change detection is the mechanism responsible for data binding in Angular. Thanks to it you don’t need to manually manipulate the DOM tree. Instead, y">
    

    <!--Author-->
    
        <meta name="author" content="Miłosz Piechocki">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="Change detection in Angular versus AngularJS">
    

    <!--Open Graph Description-->
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="codewithstyle.info">

    <!--Type page-->
    
        <meta property="og:type" content="article">
    

    <!--Page Cover-->
    

    <meta name="twitter:card" content="summary">
    

    <!-- Title -->
    
    <title>Change detection in Angular versus AngularJS - codewithstyle.info</title>

    <!-- Tachyons Core CSS -->
    <link rel="stylesheet" href="//unpkg.com/tachyons/css/tachyons.min.css">

    <!-- Custom Fonts -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Google Analytics -->
    


</head>


<body>

<!-- Main Content -->
<!-- Check if it is a root tag or category page -->


<!-- Banner -->
<!-- Banner -->
<div class="w-100 bg-1 text-light">
    
    <div class="w-100">
        <nav class="db flex-l pv3 mw8 center items-center-l">
            <a class="db v-mid link dim w-100 w-25-l tc tl-l mb2 mb0-l white" href="/" title="codewithstyle.info">
                <img src="https://codewithstyle.info/wp-content/uploads/2017/07/CODE-WITHSTYLE-1.png" class="dib h3" alt="codewithstyle.info">
            </a>
            <div class="db v-mid w-100 w-75-l tc tr-l">
                
                    <a class="link dim f6 f5-l dib mr3 mr4-l white" href="/" title="Home">
                        Home
                    </a>
                
                    <a class="link dim f6 f5-l dib mr3 mr4-l white" href="/functional-programming" title="Functional Programming">
                        Functional Programming
                    </a>
                
                    <a class="link dim f6 f5-l dib mr3 mr4-l white" href="/archives" title="Archives">
                        Archives
                    </a>
                
                    <a class="link dim f6 f5-l dib mr3 mr4-l white" href="http://miloszpiechocki.com/" title="Author">
                        Author
                    </a>
                
            </div>
        </nav>
    </div>

    <!-- Title -->
    <div class="w-100 vh-40 dt">
        <div class="v-mid white center mw8">
            <h1 class="f1-l f2-m tc tc-m tl-ns">Change detection in Angular versus AngularJS</h1>
            <p class="f4 fw3 pab-100px tc tc-m tl-ns">2017-10-31</p>
        </div>
    </div>

    <!-- Icon -->
    <div class="relative w-100 mw8 center white dn dn-m db-ns">
        <i class="header-icon fa-file-text-o"></i>
    </div>
</div>


    <!-- Content -->
    <div class="w-100 ph2 ph4-m ph5-l mv5 mv6-l">
        <div class="content">
            <div class="mw8 center">
                            
                    <div class="w-100 mw7 fw3 lh-copy post-content">
                        <!-- Main Post Content -->
                        <p><strong>Change detection</strong> is the mechanism responsible for data binding in Angular. Thanks to it you don’t need to manually manipulate the DOM tree. Instead, you can make changes to the model and they are automatically reflected in the view. In this post I’ll try to briefly explain the differences of how change detection works in <strong>AngularJS</strong> (version 1.x) versus <strong>Angular</strong> (version 2+). Why should you care about this? It’s generally a good idea to understand how the framework you’re using works internally. The improvements in change detection contributed heavily to performance boost of the new Angular.</p>
<h2 id="When-to-detect-changes"><a href="#When-to-detect-changes" class="headerlink" title="When to detect changes?"></a>When to detect changes?</h2><p>Let’s think about how the process of change detection could look like in big picture.</p>
<ul>
<li>The application starts up and models are initialized with some values. These values are also reflected in the view.</li>
<li>The user interacts with the application. They click a button or type in some text into an input field. An event is emitted.</li>
<li>An event handler is called for that event. The code can update some property on the model.</li>
<li>The model and the view are not in sync any more. Now is the time for the framework to detect changes and update the view accordingly.</li>
</ul>
<p><img src="https://codewithstyle.info/wp-content/uploads/2017/10/Change-detection-workflow.png" alt="" title="Change detection workflow"> Now we know when change detection should be performed - whenever there is a chance that some model will be modified. In the above example it’s a handler for a user-generated event that can make changes to the model. However, there are other situations that can result in model updates such as:</p>
<ul>
<li>arrival of response to a HTTP request</li>
<li>execution of callback passed to setInterval function</li>
</ul>
<p>Wrapping up, model changes (hence change detection) always start with some sort of asynchronous event.</p>
<h2 id="Digest-cycle-vs-zones"><a href="#Digest-cycle-vs-zones" class="headerlink" title="Digest cycle vs zones"></a>Digest cycle vs zones</h2><p>We already <strong>when</strong> change detection should be called. However, we don’t know <strong>how</strong> the framework ensures that it will be called. This is the first of the differences between Angular and AngularJS. In AngularJS change detection was invoked by calling $scope.digest(). Most of the times we didn’t have to call it manually because the framework did it for us. Directives such as ngClick or the $http service would make sure to run the digest cycle (i.e. change detection) after executing the handlers we’ve provided (that could potentially make changes to the model). The consequence of this was that in some rare cases you had to tell Angular to run the digest cycle by calling scope.$digest or scope.$apply manually. Angular takes a different, more robust approach. Instead of invoking CD manually it takes advantage of a concept called <strong>zones</strong>. Zone.js is a library which allows you to inject your own code into some low level calls. In particular, it allows Angular to run change detection code automatically after an asynchronous event is handled.  </p>
<h2 id="Multiple-passes-vs-single-pass"><a href="#Multiple-passes-vs-single-pass" class="headerlink" title="Multiple passes vs single pass"></a>Multiple passes vs single pass</h2><p>Let’s now focus on the change detection mechanism itself. It’s actually quite simple - the framework keeps track of values in the model before and after running your event handlers. Change detection simply looks at these values and compares them. Once it finds some differences, it’s able to tell that a change in the model has occurred. Such mechanism is called <strong>dirty checking</strong>.</p>
<h3 id="Digest-loop-in-AngularJS"><a href="#Digest-loop-in-AngularJS" class="headerlink" title="Digest loop in AngularJS"></a>Digest loop in AngularJS</h3><p>Whenever we use a data binding or pass an expression to ng-if or ng-for we create a watcher. During the $digest call, AngularJS iterates over all watchers and compares old values of watched expressions with new values. The tricky part is that <strong>AngularJS allows two-way data binding</strong>. That means that after a change in the model is reflected in the view, it might turn out that the change in the view triggers another change in the model. Therefore, a single pass through the watcher array may not be enough. AngularJS repeats the process until it detects no more changes in the model. Unfortunately, it’s quite easy to write code in a way that the model never stabilizes. What’s more, having to iterate over the watchers so many times is not great in terms of performance.</p>
<p>$scope.$watch(‘foo’, function() {<br>  $scope.foo = $scope.foo + 1;<br>});</p>
<p>Above you can see an example of infinite digest loop taken from Angular documentation.</p>
<h3 id="Unidirectional-data-flow-in-Angular"><a href="#Unidirectional-data-flow-in-Angular" class="headerlink" title="Unidirectional data flow in Angular"></a>Unidirectional data flow in Angular</h3><p>Angular is smarter about this. It doesn’t support two-way data binding any more. Therefore, it can assume that a single pass of change detection will always be sufficient. This concept has a name - it’s called <strong>unidirectional data flow</strong>. It’s unidirectional because the data always flow from the model to the template. It’s not possible for a view change resulting from change detection to trigger a change in the model - this would be data flowing in the other direction. Hey, but isn’t [(ngModel)] a two-way data binding? Actually, it’s not. It’s just a syntactic sugar for a simultanous event binding and property binding. Importantly, it still works with single pass change detection. Unidirectional data flow is a major simplification when compared with AngularJS. It makes your application more predictable. It’s also much better in terms of performance.</p>
<h2 id="Dynamic-vs-static-dirty-checking"><a href="#Dynamic-vs-static-dirty-checking" class="headerlink" title="Dynamic vs static dirty checking"></a>Dynamic vs static dirty checking</h2><p>Finally, AngularJS and Angular differ in how the dirty checking mechanism is implemented. In AngularJS the mechanism is dynamic. It means that watchers are created and added to the array during runtime, on demand. Angular takes a different approach. It generates a change detector for every single component. Such change detector is based on the template so it only compares the values of expressions used in property bindings. With <a href="https://codewithstyle.info/ahead-of-time-compilation-angular/">Ahead of Time compilation</a> enabled, Angular can generate change detectors during build time! Such change detectors are much easier to optimize for the JavaScript Virtual Machine than the dynamic mechanism used by AngularJS. We say that <strong>change detection in Angular is VM-friendly</strong>. This has major performance implications.</p>
<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>In this article I’ve explained basics of change detection in Angular. Having understood this it’s easier to understand some of the design choices taken in Angular versus AngularJS. To wrap up, here is a table that summarizes the major differences.</p>

                    </div>
                
            </div>
        </div>
    </div>


<!-- Footer -->
<div class="bg-1 ph2 ph5-ns pv5">
        <div class="mv8">
            <div class="center tc">
                
                    <div class="dib mh3">
                        <a class="f3 f2-ns white dim" href="http://twitter.com/miloszpp/" target="_blank">
                            <i class="fab fa-twitter"></i>
                        </a>
                    </div>
                
                    <div class="dib mh3">
                        <a class="f3 f2-ns white dim" href="http://facebook.com/codewithstyle.info/" target="_blank">
                            <i class="fab fa-facebook"></i>
                        </a>
                    </div>
                
                    <div class="dib mh3">
                        <a class="f3 f2-ns white dim" href="https://github.com/miloszpp" target="_blank">
                            <i class="fab fa-github"></i>
                        </a>
                    </div>
                
                    <div class="dib mh3">
                        <a class="f3 f2-ns white dim" href="https://www.youtube.com/channel/UC_DEBDpgRyBZAT85tJ1QZBw" target="_blank">
                            <i class="fab fa-youtube"></i>
                        </a>
                    </div>
                
                    <div class="dib mh3">
                        <a class="f3 f2-ns white dim" href="mailto:milosz@miloszpiechocki.com" target="_blank">
                            <i class="fas fa-envelope"></i>
                        </a>
                    </div>
                
                    <div class="dib mh3">
                        <a class="f3 f2-ns white dim" href="/#" target="_blank">
                            <i class="fas fa-rss"></i>
                        </a>
                    </div>
                
            </div>
            <div class="f6 f5-ns center tc white pt5 fw3">
                @Copyright Miłosz Piechocki. All right reserved | Design & Hexo based on Anodyne by <a class="link dim white" href="http://www.codeblocq.com/">Jonathan Klughertz</a>
            </div>
        </div>
    </div>

<!-- After Footer -->
<!-- Disqus Comments -->



</body>

</html>