<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!--Description-->
  
  <meta name="description" content="This post is another attempt on explaining the M word in an approachable way. This explanation will best suite C# developers who are familiar with LIN">
  

  <!--Author-->
  
  <meta name="author" content="Mi≈Çosz Piechocki">
  

  <!--Open Graph Title-->
  
  <meta property="og:title" content="Understand monads with LINQ">
  

  <!--Open Graph Description-->
  

  <!--Open Graph Site Name-->
  <meta property="og:site_name" content="codewithstyle.info">

  <!--Type page-->
  
  <meta property="og:type" content="article">
  

  <!--Page Cover-->
  
  <meta name="twitter:card" content="summary">
   

  <!-- Title -->
  
  <title>Understand monads with LINQ - codewithstyle.info</title>

  <!-- Tachyons Core CSS -->
  <link rel="stylesheet" href="//unpkg.com/tachyons/css/tachyons.min.css">

  <!-- Custom Fonts -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">

  
  <link rel="amphtml" href="https://codewithstyle.info/understand-monads-linq//amp/index.html">
  

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/css/style.css">

  <!-- Google Analytics -->
  
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-89535231-1', 'auto');
        ga('send', 'pageview');

    </script>



  <!-- Twitter -->
  <script>
    window.twttr = (function (d, s, id) {
      var js,
        fjs = d.getElementsByTagName(s)[0],
        t = window.twttr || {};
      if (d.getElementById(id)) return t;
      js = d.createElement(s);
      js.id = id;
      js.src = "https://platform.twitter.com/widgets.js";
      fjs.parentNode.insertBefore(js, fjs);

      t._e = [];
      t.ready = function (f) {
        t._e.push(f);
      };

      return t;
    })(document, "script", "twitter-wjs");
  </script>

  <!-- MailerLite Universal -->
  <script>
    (function (m, a, i, l, e, r) {
      m["MailerLiteObject"] = e;
      function f() {
        var c = { a: arguments, q: [] };
        var r = this.push(c);
        return "number" != typeof r ? r : f.bind(c.q);
      }
      f.q = f.q || [];
      m[e] = m[e] || f.bind(f.q);
      m[e].q = m[e].q || f.q;
      r = a.createElement(i);
      var _ = a.getElementsByTagName(i)[0];
      r.async = 1;
      r.src = l + "?v" + ~~(new Date().getTime() / 1000000);
      _.parentNode.insertBefore(r, _);
    })(
      window,
      document,
      "script",
      "https://static.mailerlite.com/js/universal.js",
      "ml"
    );

    var ml_account = ml("accounts", "1785990", "w8k8t0a5z1", "load");
  </script>
  <!-- End MailerLite Universal -->
</head>


<body>

<!-- Main Content -->
<!-- Banner -->
<!-- Banner -->
<div class="w-100 bg-1 text-light">
  <div class="w-100">
    <nav class="db flex-l pv3 mw8 center items-center-l">
      <a class="db v-mid link dim w-100 w-25-l tc tl-l mb2 mb0-l white" href="/" title="codewithstyle.info">
        <img src="/images/2017/07/CODE-WITHSTYLE-1.png" class="dib h3" alt="codewithstyle.info">
      </a>
      <div class="db v-mid w-100 w-75-l tc tr-l">
        
        <a class="link dim f6 f5-l dib mr3 mr4-l white" href="/toc" title="Table of Contents">
          Table of Contents
        </a>
        
        <a class="link dim f6 f5-l dib mr3 mr4-l white" href="/tags/typescript" title="TypeScript">
          TypeScript
        </a>
        
        <a class="link dim f6 f5-l dib mr3 mr4-l white" href="/functional-programming" title="Functional Programming">
          Functional Programming
        </a>
        
        <a class="link dim f6 f5-l dib mr3 mr4-l white" href="http://miloszpiechocki.com/" title="Author">
          Author
        </a>
        
      </div>
    </nav>
  </div>

  <!-- Title -->
  <div class="w-100 vh-40 dt" style="background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)),
    url('images/homepage.png'); background-size: cover; background-position: center">
    <div class="v-mid white center mw8">
      <h1 class="f1-l f2-m tc tc-m tl-ns">Understand monads with LINQ</h1>
      <p class="f4 fw3 pab-100px tc tc-m tl-ns">2017-03-18</p>
    </div>
  </div>

  <div class="w-100 bt">
    <section class="pa2 mw8 center white">
      <a class="link white dim" href="https://typescriptmasterclass.com">
        üî• Check out my <em>Advanced TypeScript Masterclass book</em> üî•
      </a>
    </section>
  </div>
</div>


<!-- Content -->
<div class="w-100 ph2 ph4-m ph5-l mv5 mv6-l">
    <div class="content">
        <div class="mw8 center">
            <div class="cf">
                <div class="fl w-100 w-70-l mw7 left fw3 lh-copy pr4-ns pr0-m post-content">
                    <!-- Tags Vertical -->
                    
                        <div class="tags-container-vertical">
                            <div class="tags-sub-container">
                                <a class="fw3 ph1 dib" href="/tags/functional-programming/">#functional programming</a> <a class="fw3 ph1 dib" href="/tags/monads/">#monads</a> <a class="fw3 ph1 dib" href="/tags/csharp/">#csharp</a>
                            </div>
                        </div>
                    

                    <!-- Main Post Content -->
                    <p>This post is another attempt on explaining <strong>the M word</strong> in an approachable way. This explanation will best suite C# developers who are familiar with LINQ and query expressions. However, if you are not familiar with C# but would like to learn how powerful and expressive some of its features are, please read on!</p>
<h3 id="Recap-of-LINQ-and-query-expressions"><a href="#Recap-of-LINQ-and-query-expressions" class="headerlink" title="Recap of LINQ and query expressions"></a>Recap of LINQ and query expressions</h3><p>LINQ is a technology introduced in C# 3.0 and .NET 3.5. One of its major applications is processing collections in an elegant, declarative way. Here‚Äôs an example of LINQ‚Äôs s_elect_ expression:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> numbers = <span class="keyword">new</span>[] &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span> &#125;;</span><br><span class="line"><span class="keyword">var</span> squares = numbers.Select(x =&gt; x * x);</span><br></pre></td></tr></table></figure>
<p>Query expressions are one of the language features which constitute LINQ. Thanks to it LINQ expressions can look in a way which resembles SQL expressions:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> squares = <span class="keyword">from</span> x <span class="keyword">in</span> numbers <span class="keyword">select</span> x * x;</span><br></pre></td></tr></table></figure>
<p>Before LINQ you would need to write a horrible, imperative loop which literates over the <em>numbers</em> array and appends the results to a new array.</p>
<h3 id="Single-element-collection-Maybe-class"><a href="#Single-element-collection-Maybe-class" class="headerlink" title="Single element collection: Maybe class"></a>Single element collection: Maybe class</h3><p>It‚Äôs pretty easy to understand what <em>select</em> expression does in the above example: it apples a given expression to each element of a collection and produces a collection containing the results. Let‚Äôs now imagine that instead of arbitrary collection, we are working with a special kind of collection - one that can have either one element or no elements at all. In other words, it‚Äôs either empty, or full. How should <em>select</em> expression act on such a collection? Exactly the same way that it works with regular collections. If our collection has one element than apply the given expression to it and return a new collection with the result. If the collection is empty, just return an empty collection. Note that such a special collection is actually quite interesting - it represents an object that either has a value or is empty. Let‚Äôs create such an object and call it <em>Maybe</em>.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class Maybe&lt;TValue&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> TValue <span class="keyword">value</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="keyword">bool</span> hasValue;</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">internal</span> <span class="title">Maybe</span>(<span class="params">TValue <span class="keyword">value</span>, <span class="keyword">bool</span> hasValue</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.<span class="keyword">value</span> = <span class="keyword">value</span>;</span><br><span class="line">        <span class="keyword">this</span>.hasValue = hasValue;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Let‚Äôs create two factory methods to allow more convenient creation of instances of <em>Maybe</em>.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">MaybeFactory</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Maybe&lt;T&gt; Some&lt;T&gt;(T <span class="keyword">value</span>) =&gt; <span class="keyword">new</span> Maybe&lt;T&gt;(<span class="keyword">value</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Maybe&lt;T&gt; None&lt;T&gt;() =&gt; <span class="keyword">new</span> Maybe&lt;T&gt;(<span class="keyword">default</span>(T), <span class="literal">false</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Thanks to type inference in generic method calls and the <strong>static using</strong>feature we can now simply write:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> some = Some(<span class="number">10</span>);</span><br><span class="line"><span class="keyword">var</span> none = None&lt;<span class="keyword">int</span>&gt;();</span><br></pre></td></tr></table></figure>
<h3 id="Making-Maybe-LINQ-friendly"><a href="#Making-Maybe-LINQ-friendly" class="headerlink" title="Making Maybe LINQ-friendly"></a>Making Maybe LINQ-friendly</h3><p>Since we‚Äôve already discussed how <em>select</em> would work on <em>Maybe</em>, let‚Äôs implement it! Adding support for query expressions to your custom types is surprisingly easy. You just need to define a method which confirms to a specific signature (it‚Äôs an interesting design decision by C# creators which allows more flexibility than requiring the type to implement a specific interface).</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Maybe&lt;TResult&gt; Select&lt;TResult&gt;(Func&lt;TValue, TResult&gt; mapperExpression)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.hasValue)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> MaybeFactory.Some(mapperExpression(<span class="keyword">this</span>.<span class="keyword">value</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> MaybeFactory.None&lt;TResult&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>What‚Äôs going on here? Firstly, let‚Äôs take a look at the signature. Our method takes a function which transforms the value contained by <em>Maybe</em> to another type.  It returns an instance of <em>Maybe</em> containing an instance of the result type. If it‚Äôs confusing, just replace <em>Maybe</em> with <em>List</em> or _IEnumerable. _It makes perfect sense to write a <em>select</em> expression which transforms a list of <em>ints</em> to a list of <em>strings</em>. It works the same way with our <em>Maybe</em> type. <img src="/images/2017/03/select-1.png" alt="" title="select"> Now, the implementation. There are two cases:</p>
<ul>
<li>If the object contains a value than apply the <em>mapper</em> function and return a new <em>Maybe</em> instance with the result</li>
<li>If the object is empty, there is nothing to convert - return a new empty <em>Maybe</em> instance</li>
</ul>
<p>Let‚Äôs give it a try:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Maybe&lt;<span class="keyword">int</span>&gt; age = Some(<span class="number">27</span>);</span><br><span class="line">Maybe&lt;<span class="keyword">string</span>&gt; result = <span class="keyword">from</span> x <span class="keyword">in</span> age <span class="keyword">select</span> <span class="keyword">string</span>.Format(<span class="string">"I'am &#123;0&#125; years old"</span>, x);</span><br></pre></td></tr></table></figure>
<p>Nice! We can now use <em>select</em> expressions with <em>Maybe</em> type.</p>
<h3 id="Taking-it-one-step-further"><a href="#Taking-it-one-step-further" class="headerlink" title="Taking it one step further"></a>Taking it one step further</h3><p>Let‚Äôs now imagine that given an employee‚Äôs id, our goal is to return the name of theirs supervisor‚Äôs supervisor. A person can but does not have to have a supervisor. We are given a repository class with the following method:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Person <span class="title">GetPersionById</span>(<span class="params">Guid id</span>) </span>&#123; ... &#125;</span><br></pre></td></tr></table></figure>
<p>And a <em>Person</em> class:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Person</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> Person ReportsTo &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>In order to find the person‚Äôs supervisor‚Äôs supervisor‚Äôs name we would need to write a series of _if_ statements:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">string</span> <span class="title">GetSupervisorSupervisorName</span>(<span class="params">Person employee</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (employee != <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (employee.ReportsTo != <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (employee.ReportsTo.ReportsTo != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> employee.ReportsTo.ReportsTo.Name;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Can we improve this code with our new <em>Maybe</em> type? Of course we can! First of all, since <em>Maybe</em> represents a value which may or may not exist, it seems reasonable for <em>GetPersonById</em> to return <em>Maybe<person></person></em> instead of <em>Person</em>.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Maybe&lt;Person&gt; <span class="title">GetPersonById</span>(<span class="params">Guid id</span>)</span></span><br></pre></td></tr></table></figure>
<p>Next, let‚Äôs modify the <em>Person</em> class. Since a person can either have or not have a supervisor, it‚Äôs again a good fit for the <em>Maybe</em> type:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">MonadicPerson</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> Maybe&lt;MonadicPerson&gt; ReportsTo &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Given these modifications we can now rewrite <em>GetSupervisorSupervisorName</em> in a neater and more elegant way:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Maybe&lt;<span class="keyword">string</span>&gt; <span class="title">GetSupervisorName</span>(<span class="params">Maybe&lt;MonadicPerson&gt; maybeEmployee</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">from</span> employee <span class="keyword">in</span> maybeEmployee</span><br><span class="line">           <span class="keyword">from</span> supervisor <span class="keyword">in</span> employee.ReportsTo</span><br><span class="line">           <span class="keyword">from</span> supervisorSupervisor <span class="keyword">in</span> supervisor.ReportsTo</span><br><span class="line">           <span class="keyword">select</span> supervisorSupervisor.Name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Why is this better than the previous version? First of all, we explicitly represent the fact that given a person, the method might or might not return a valid result. Previously, the method always returned a <em>string</em>. There was no way to indicate that it can sometimes return <em>null</em> (apart from a comment). A user of such a method could forget to perform null check and in consequence be surprised by a runtime error. What‚Äôs more, we avoid the nesting of if statements. In this example we only go two levels deep. What if there were 5 levels? Code without these nested if statements is much cleaner and more readable. It expresses the actual logic, not on the boilerplate of null-checking.</p>
<h3 id="Making-it-work"><a href="#Making-it-work" class="headerlink" title="Making it work"></a>Making it work</h3><p>If you‚Äôre copying these snippets to Visual Studio, you might have noticed that the last one won‚Äôt compile. By implementing <em>Select</em> we told the compiler how to apply functions to values inside <em>Maybe</em> instances. However, here we have a slightly more complex situation. We take a value which sits inside a <em>Maybe</em> instance and apply a function to it. As a result we get another <em>Maybe</em> instance, so now we have a <em>Maybe</em> inside a <em>Maybe</em>. The compiler doesn‚Äôt know how to handle this situation and we need to tell it by implementing <em>SelectMany</em>.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Maybe&lt;TResult&gt; SelectMany&lt;TIntermediate, TResult&gt;(</span><br><span class="line">    Func&lt;TValue, Maybe&lt;TIntermediate&gt;&gt; mapper,</span><br><span class="line">    Func&lt;TValue, TIntermediate, TResult&gt; getResult</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.hasValue)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> intermediate = mapper(<span class="keyword">this</span>.<span class="keyword">value</span>);</span><br><span class="line">        <span class="keyword">if</span> (intermediate.hasValue)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> MaybeFactory.Some(getResult(<span class="keyword">this</span>.<span class="keyword">value</span>, intermediate.<span class="keyword">value</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> MaybeFactory.None&lt;TResult&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The first parameter to <em>SelectMany</em> is a function which takes a value (which sits inside <em>Maybe</em>) and returns a new <em>Maybe</em>. In our example, that would be a function which takes a <em>Person</em> and returns its <em>ReportsTo</em> property. The second parameter is a function which takes the original value, the value sitting inside <em>Maybe</em> returned by the first parameter and transforms both into a result. In our case that would be a function which takes a <em>Person</em> and returns its <em>Name</em>. Inside the implementation we have the nested if statements that we had to write when we didn‚Äôt use the _Maybe _type. And this is the crucial idea about monads - they help you hide ugly boilerplate code and let the developer focus on the actual logic. Again, let me draw a diagram for those of you who prefer visual aids: <img src="/images/2017/03/SelectMany.png" alt="" title="SelectMany"></p>
<h3 id="Ok-so-what‚Äôs-exactly-a-Monad"><a href="#Ok-so-what‚Äôs-exactly-a-Monad" class="headerlink" title="Ok, so what‚Äôs exactly a Monad?"></a>Ok, so what‚Äôs exactly a Monad?</h3><p>Monad is any generic type which implements _SelectMany _(strictly speaking, this is far from a formal definition, but I think it‚Äôs sufficient in this context and captures the core idea). <em>SelectMany</em> is a slightly more general version of an operation which in the functional programming world is referred to as <strong>bind</strong>. Monadic types are like wrappers around some values. Binding monads is all about composing them. By wrapping and unwrapping of the values inside monads, we can perform additional operations (such as handling empty results in our case) and hide them away from the user. <em>Maybe</em> is a classic example of a monad. Another great candidate for monad is C#‚Äôs <em>Task<t></t></em> type. You can think of it as a type that wraps some value (the one that will be returned when the task completes). By combining tasks you describe that one task should be executed after the other finishes.</p>
<h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h3><p>I hope this article helped you understand what monads are about. If you find this interesting, check out the F# programming language where monads are much more common and feel more natural. Check out this excellent resource about F#: <a href="https://fsharpforfunandprofit.com/" target="_blank" rel="noopener">https://fsharpforfunandprofit.com/</a>. It‚Äôs also worth mentioning that there exists an interesting C# library which exploits the concepts I described in this article: <a href="https://github.com/louthy/csharp-monad" target="_blank" rel="noopener">https://github.com/louthy/csharp-monad</a>. Check it out if you‚Äôre interested.</p>


                    


                    <div class="social-sharing pv3">
                      <h5 class="mv1">Enjoyed it? Let others hear about it too! ‚ù§Ô∏è</h5>
                      <div class="flex items-center">
                        <a class="twitter-share-button" href="https://twitter.com/intent/tweet?text=Understand monads with LINQ by @miloszpp" data-size="large">
                          Tweet
                        </a>
                        <div class="fb-share-button mh1" data-href="167.html" data-layout="button_count" data-size="large">
                        </div>
                      </div>
                    </div>
                    
                    <!-- Tags Bottom -->
                    
                        <div class="tags-container-bottom">
                            <i class="fa fa-tag pr3 text-main-color"></i><a class="fw3 ph1 dib" href="/tags/functional-programming/">#functional programming</a> <a class="fw3 ph1 dib" href="/tags/monads/">#monads</a> <a class="fw3 ph1 dib" href="/tags/csharp/">#csharp</a>
                        </div>
                    

                    <!-- Comments -->
                    
<div id="disqus_thread" class="mt5">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>



                    

                </div>
                <div class="fl w-100 w-30-l center fw3 lh-copy pl4-ns tl black-50">
                <hr class="dn-l mw4 black-50 mt5">

<div class="mt5 mt0-l">
    <article class="dt db-l mw8 mw8-m mw5-ns center ml0-l bg-white mv3">
        <div class="dn dtc-m db-l v-mid tc pr4 pr0-l" style="min-width: 6rem;">
            <img src="/images/speaker-avatar-2.png" class="mb4-l br-100 h3 w3 h4-l w4-l dib" title="Mi≈Çosz Piechocki">
        </div>
        <div class="dtc db-l v-mid lh-copy measure center f6 black-50 tj">
            Hi! My name is Mi≈Çosz Piechocki. I‚Äôm a software developer living in Warsaw, Poland. I‚Äôm passionate about TypeScript, JavaScript and functional programming in modern web development.
        </div>
        <div class="mt3">
          <a class="twitter-follow-button" data-show-count="false" href="https://twitter.com/miloszpp">
            Follow me on Twitter</a>
        </div>
    </article>
</div>

<hr class="dn-l mw4 black-50 mt5">

<div class="mt5 tc tl-l">
  <h3>Free download</h3>
  <a href="/10tips"><img src="/images/10tips.png"></a>
</div>

<hr class="dn-l mw4 black-50 mt5">

                </div>
            </div>
        </div>
    </div>
</div>


<!-- Footer -->
<div class="bg-1 ph2 ph5-ns pv5">
    <div class="mv8">
        <div class="center tc">
            
                <div class="dib mh3">
                    <a class="f3 f2-ns white dim" href="http://twitter.com/miloszpp/" target="_blank">
                        <i class="fab fa-twitter"></i>
                    </a>
                </div>
            
                <div class="dib mh3">
                    <a class="f3 f2-ns white dim" href="http://facebook.com/codewithstyle.info/" target="_blank">
                        <i class="fab fa-facebook"></i>
                    </a>
                </div>
            
                <div class="dib mh3">
                    <a class="f3 f2-ns white dim" href="https://github.com/miloszpp" target="_blank">
                        <i class="fab fa-github"></i>
                    </a>
                </div>
            
                <div class="dib mh3">
                    <a class="f3 f2-ns white dim" href="https://www.youtube.com/channel/UC_DEBDpgRyBZAT85tJ1QZBw" target="_blank">
                        <i class="fab fa-youtube"></i>
                    </a>
                </div>
            
                <div class="dib mh3">
                    <a class="f3 f2-ns white dim" href="mailto:milosz@miloszpiechocki.com" target="_blank">
                        <i class="fas fa-envelope"></i>
                    </a>
                </div>
            
                <div class="dib mh3">
                    <a class="f3 f2-ns white dim" href="/atom.xml" target="_blank">
                        <i class="fas fa-rss"></i>
                    </a>
                </div>
            
        </div>
        <div class="f6 f5-ns center tc white pt5 fw3">
            @Copyright Mi≈Çosz Piechocki. All right reserved | Design & Hexo based on Anodyne by <a class="link dim white" href="http://www.codeblocq.com/">Jonathan Klughertz</a>
        </div>
    </div>
</div>

  <!-- Load Facebook SDK for JavaScript -->
  <div id="fb-root"></div>
  <script>(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));</script>

<!-- After Footer -->
<!-- Disqus Comments -->

<script type="text/javascript">
    var disqus_shortname = 'codewithstyle';

    (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



</body>

</html>