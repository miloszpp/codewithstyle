<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!--Description-->
  
  <meta name="description" content="Some time ago I wrote about generic type arguments propagation feature added in TypeScript version 3.4. I explained how this improvement makes point-f">
  

  <!--Author-->
  
  <meta name="author" content="Mi≈Çosz Piechocki">
  

  <!--Open Graph Title-->
  
  <meta property="og:title" content="Typing Higher Order Components in React">
  

  <!--Open Graph Description-->
  

  <!--Open Graph Site Name-->
  <meta property="og:site_name" content="codewithstyle.info">

  <!--Type page-->
  
  <meta property="og:type" content="article">
  

  <!--Page Cover-->
  
  <meta property="og:image" content="https://codewithstyle.info/images/posts/archive.jpg">
  <meta property="twitter:image" content="https://codewithstyle.info/images/posts/archive.jpg">
  <meta name="twitter:card" content="summary_large_image">
   

  <!-- Title -->
  
  <title>Typing Higher Order Components in React - codewithstyle.info</title>

  <!-- Tachyons Core CSS -->
  <link rel="stylesheet" href="//unpkg.com/tachyons/css/tachyons.min.css">

  <!-- Custom Fonts -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">

  
  <link rel="amphtml" href="https://codewithstyle.info/Typing-Higher-Order-Components-in-React//amp/index.html">
  

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/css/style.css">

  <!-- Google Analytics -->
  
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-89535231-1', 'auto');
        ga('send', 'pageview');

    </script>



  <!-- Twitter -->
  <script>
    window.twttr = (function (d, s, id) {
      var js,
        fjs = d.getElementsByTagName(s)[0],
        t = window.twttr || {};
      if (d.getElementById(id)) return t;
      js = d.createElement(s);
      js.id = id;
      js.src = "https://platform.twitter.com/widgets.js";
      fjs.parentNode.insertBefore(js, fjs);

      t._e = [];
      t.ready = function (f) {
        t._e.push(f);
      };

      return t;
    })(document, "script", "twitter-wjs");
  </script>

  <!-- MailerLite Universal -->
  <script>
    (function (m, a, i, l, e, r) {
      m["MailerLiteObject"] = e;
      function f() {
        var c = { a: arguments, q: [] };
        var r = this.push(c);
        return "number" != typeof r ? r : f.bind(c.q);
      }
      f.q = f.q || [];
      m[e] = m[e] || f.bind(f.q);
      m[e].q = m[e].q || f.q;
      r = a.createElement(i);
      var _ = a.getElementsByTagName(i)[0];
      r.async = 1;
      r.src = l + "?v" + ~~(new Date().getTime() / 1000000);
      _.parentNode.insertBefore(r, _);
    })(
      window,
      document,
      "script",
      "https://static.mailerlite.com/js/universal.js",
      "ml"
    );

    var ml_account = ml("accounts", "1785990", "w8k8t0a5z1", "load");
  </script>
  <!-- End MailerLite Universal -->
</head>


<body>

<!-- Main Content -->
<!-- Banner -->
<!-- Banner -->
<div class="w-100 bg-1 text-light">
  <div class="w-100">
    <nav class="db flex-l pv3 mw8 center items-center-l">
      <a class="db v-mid link dim w-100 w-25-l tc tl-l mb2 mb0-l white" href="/" title="codewithstyle.info">
        <img src="/images/2017/07/CODE-WITHSTYLE-1.png" class="dib h3" alt="codewithstyle.info">
      </a>
      <div class="db v-mid w-100 w-75-l tc tr-l">
        
        <a class="link dim f6 f5-l dib mr3 mr4-l white" href="/toc" title="Table of Contents">
          Table of Contents
        </a>
        
        <a class="link dim f6 f5-l dib mr3 mr4-l white" href="/tags/typescript" title="TypeScript">
          TypeScript
        </a>
        
        <a class="link dim f6 f5-l dib mr3 mr4-l white" href="/functional-programming" title="Functional Programming">
          Functional Programming
        </a>
        
        <a class="link dim f6 f5-l dib mr3 mr4-l white" href="http://miloszpiechocki.com/" title="Author">
          Author
        </a>
        
      </div>
    </nav>
  </div>

  <!-- Title -->
  <div class="w-100 vh-40 dt" style="background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)),
    url('/images/posts/archive.jpg'); background-size: cover; background-position: center">
    <div class="v-mid white center mw8">
      <h1 class="f1-l f2-m tc tc-m tl-ns">Typing Higher Order Components in React</h1>
      <p class="f4 fw3 pab-100px tc tc-m tl-ns">2019-08-14</p>
    </div>
  </div>

  <div class="w-100 bt">
    <section class="pa2 mw8 center white">
      <a class="link white dim" href="https://typescriptmasterclass.com">
        üî• Check out my <em>Advanced TypeScript Masterclass e-book</em> üî•
      </a>
    </section>
  </div>
</div>


<!-- Content -->
<div class="w-100 ph2 ph4-m ph5-l mv5 mv6-l">
    <div class="content">
        <div class="mw8 center">
            <div class="cf">
                <div class="fl w-100 w-70-l mw7 left fw3 lh-copy pr4-ns pr0-m post-content">
                    <!-- Tags Vertical -->
                    
                        <div class="tags-container-vertical">
                            <div class="tags-sub-container">
                                <a class="fw3 ph1 dib" href="/tags/typescript/">#typescript</a> <a class="fw3 ph1 dib" href="/tags/functional-programming/">#functional programming</a> <a class="fw3 ph1 dib" href="/tags/react/">#react</a> <a class="fw3 ph1 dib" href="/tags/generics/">#generics</a>
                            </div>
                        </div>
                    

                    <!-- Main Post Content -->
                    <p>Some time ago <a href="https://codewithstyle.info/TypeScript-3-4-hidden-gem-propagated-generic-type-arguments/">I wrote about</a> generic type arguments propagation feature added in TypeScript version 3.4. I explained how this improvement makes point-free style programming possible in TypeScript. </p>
<p>As it turns out, there are more cases in which propagation of generic type arguments is desirable. One of them is passing a generic component to a Higher Order Component in React.</p>
<p><blockquote class="twitter-tweet"><p lang="en" dir="ltr">.<a href="https://twitter.com/orta?ref_src=twsrc%5Etfw" target="_blank" rel="noopener">@orta</a> Do you know how to Propagate Generics across higher-order-components?<br><br>I have a generic component A, whose props is type Props = PubProps&lt;B&gt; &amp; InjectedProps<br>I have a <code>bind()</code>-HoC that injects InjectedProps<br><br>I want return value from bind:<br>APrime&lt;B&gt; accepting PubProps&lt;B&gt;</p>&mdash; Frederic Barthelemy (@fbartho) <a href="https://twitter.com/fbartho/status/1154542230641623040?ref_src=twsrc%5Etfw" target="_blank" rel="noopener">July 26, 2019</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></p>
<p><em>The post is inspired by the problem <a href="https://twitter.com/fbartho" target="_blank" rel="noopener">Frederic Barthelemy</a> tweeted about and asked me to have a look at.</em></p>
<h2 id="Higher-Order-Components"><a href="#Higher-Order-Components" class="headerlink" title="Higher Order Components"></a>Higher Order Components</h2><p>I‚Äôm not going to give a detailed explanation, as there are already plenty to be found on the internet. <strong>Higher Order Component (HOC)</strong> is a concept of the React framework that lets you abstract cross-cutting functionality and provide it to multiple components.</p>
<p>Technically, HOC is a function that takes a component and returns another component. It usually augments the source component with some behavior or provides some properties required by the source component.</p>
<p>Here is an example of a HOC in TypeScript:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> withLoadingIndicator = </span><br><span class="line">    &lt;P <span class="keyword">extends</span> &#123;&#125;&gt;(Component: ComponentType&lt;P&gt;): ComponentType&lt;P &amp; &#123; isLoading: <span class="built_in">boolean</span> &#125;&gt; =&gt; </span><br><span class="line">        (&#123; isLoading, ...props &#125;) =&gt;</span><br><span class="line">            isLoading </span><br><span class="line">                ? &lt;span&gt;Loading...&lt;<span class="regexp">/span&gt; </span></span><br><span class="line"><span class="regexp">                : &lt;Component &#123;...props as P&#125; /</span>&gt;;</span><br></pre></td></tr></table></figure>
<p>As you can deduce from the type signature, <code>withLoadingIndicator</code> is a function that accepts a component with <code>P</code>-shaped properties and returns a component that additionally has <code>isLoading</code> property. It adds the behavior of displaying loading indicator based on <code>isLoading</code> property.</p>
<p><img src="/images/posts/hoc.png" alt="HOC type"></p>
<h2 id="Problem-passing-a-generic-component-to-a-HOC"><a href="#Problem-passing-a-generic-component-to-a-HOC" class="headerlink" title="Problem: passing a generic component to a HOC"></a>Problem: passing a generic component to a HOC</h2><p>So far so good. However, let‚Äôs imagine that we have a <strong>generic component</strong> <code>Header</code>:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Header&lt;TContent&gt; <span class="keyword">extends</span> React.Component&lt;HeaderProps&lt;TContent&gt;&gt; &#123; &#125;</span><br></pre></td></tr></table></figure>
<p>‚Ä¶where <code>HeaderProps</code> is a generic type that represents <code>Header</code>‚Äòs props given the type of associated content (<code>TContent</code>):</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> HeaderProps&lt;TContent&gt; = &#123;</span><br><span class="line">    content: TContent;</span><br><span class="line">    title: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Next, let‚Äôs use <code>withLoadingIndicator</code> with this <code>Header</code> component.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> HeaderWithLoader = withLoadingIndicator(Header);</span><br></pre></td></tr></table></figure>
<p>The question is, what is the inferred type of <code>HeaderWithLoader</code>? Unfortunately, it‚Äôs <code>React.ComponentType&lt;HeaderProps&lt;unknown&gt; &amp; { isLoading: boolean; }&gt;</code> in TypeScript 3.4 and later or <code>React.ComponentType&lt;HeaderProps&lt;{}&gt; &amp; { isLoading: boolean; }&gt;</code> in previous versions. </p>
<p>As you can see, <code>HeaderWithLoader</code> is <strong>not</strong> a generic component. In other words, generic type argument of <code>Header</code> was <strong>not propagated</strong>. Wait‚Ä¶ doesn‚Äôt TypeScript 3.4 introduce generic type argument propagation?</p>
<h2 id="Solution-use-function-components"><a href="#Solution-use-function-components" class="headerlink" title="Solution: use function components!"></a>Solution: use function components!</h2><p>Actually, it does. However, it only works for <strong>functions</strong>. <code>Header</code> is a generic class, not a generic function. Therefore, the improvement introduced in TypeScript 3.4 doesn‚Äôt apply here ‚òπÔ∏è</p>
<p>Fortunately, we have <strong>function components</strong> in React. We can make type argument propagation work if we limit <code>withLoadingIndicator</code> to only work with function components.</p>
<p>Unfortunately, we cannot use <code>FunctionComponent</code> type since it is defined as an interface, not a function type. However, a function component is nothing else but a generic function that takes props and returns <code>React.ReactElement</code>. Let‚Äôs define our own type representing function components.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> SimpleFunctionComponent&lt;P&gt; = <span class="function">(<span class="params">props: P</span>) =&gt;</span> React.ReactElement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">const</span> withLoadingIndicator: </span><br><span class="line">    &lt;P&gt;<span class="function">(<span class="params">Component: SimpleFunctionComponent&lt;P&gt;</span>) =&gt;</span> </span><br><span class="line">        (SimpleFunctionComponent&lt;P &amp; &#123; isLoading: <span class="built_in">boolean</span> &#125;&gt;);</span><br></pre></td></tr></table></figure>
<p><em>By using <code>SimpleFunctionComponent</code> instead of <code>FunctionComponent</code> we loose access to properties such as <code>defaultProps</code>, <code>propTypes</code>, etc., which we don‚Äôt need anyway.</em></p>
<p>Obviously, we need to change <code>Header</code> to be a function component, not a class component:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="keyword">const</span> Header: &lt;TContent&gt;<span class="function">(<span class="params">props: HeaderProps&lt;TContent&gt;</span>) =&gt;</span> React.ReactElement;</span><br></pre></td></tr></table></figure>
<p><em>We wouldn‚Äôt be able to use <code>FunctionComponent</code> here anyway, since <code>Header</code> is a generic component</em>.</p>
<p>Let‚Äôs now take a look at the inferred type of <code>HeaderWithLoader</code>. It‚Äôs‚Ä¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;TContent&gt;(props: HeaderProps&lt;TContent&gt; &amp; &#123; isLoading: boolean &#125;) =&gt; React.ReactElement</span><br></pre></td></tr></table></figure>
<p>‚Ä¶which looks very much like a generic function component!</p>
<p>Indeed, we can use <code>Header</code> as a regular component in JSX:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Foo <span class="keyword">extends</span> React.Component &#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;HeaderWithLoader </span><br><span class="line">                title=<span class="string">"Hello"</span> </span><br><span class="line">                content=&#123;<span class="number">12345</span>&#125; </span><br><span class="line">                isLoading=&#123;<span class="literal">false</span>&#125; /&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Most importantly, <code>HeaderWithLoader</code> is typed correctly!</p>
<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>As you can see, typing HOCs in React can get tricky. The proposed solution is really a workaround - ideally, TypeScript should be able to propagate generic type arguments for all generic types (not only functions). </p>
<p>Anyway, this example demonstrates how important it is to stay on top of the features introduced in new TypeScript releases. Before version 3.4, it wouldn‚Äôt be even possible to get this HOC typed correctly.</p>


                    
<hr>
<p class="f5 bg-dark-gray br3 pa3 white">
  Did you like this TypeScript article? I bet you'll also like my book!<br>
  <a href="https://typescriptmasterclass.com">
    ‚≠êÔ∏è Advanced TypeScript E-book ‚≠êÔ∏è
  </a>
</p>



                    <div class="social-sharing pv3">
                      <h5 class="mv1">Enjoyed it? Let others hear about it too! ‚ù§Ô∏è</h5>
                      <div class="flex items-center">
                        <a class="twitter-share-button" href="https://twitter.com/intent/tweet?text=Typing Higher Order Components in React by @miloszpp" data-size="large">
                          Tweet
                        </a>
                        <div class="fb-share-button mh1" data-href="" data-layout="button_count" data-size="large">
                        </div>
                      </div>
                    </div>
                    
                    <!-- Tags Bottom -->
                    
                        <div class="tags-container-bottom">
                            <i class="fa fa-tag pr3 text-main-color"></i><a class="fw3 ph1 dib" href="/tags/typescript/">#typescript</a> <a class="fw3 ph1 dib" href="/tags/functional-programming/">#functional programming</a> <a class="fw3 ph1 dib" href="/tags/react/">#react</a> <a class="fw3 ph1 dib" href="/tags/generics/">#generics</a>
                        </div>
                    

                    <!-- Comments -->
                    
<div id="disqus_thread" class="mt5">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>



                    

                </div>
                <div class="fl w-100 w-30-l center fw3 lh-copy pl4-ns tl black-50">
                <hr class="dn-l mw4 black-50 mt5">

<div class="mt5 mt0-l">
    <article class="dt db-l mw8 mw8-m mw5-ns center ml0-l bg-white mv3">
        <div class="dn dtc-m db-l v-mid tc pr4 pr0-l" style="min-width: 6rem;">
            <img src="/images/speaker-avatar-2.png" class="mb4-l br-100 h3 w3 h4-l w4-l dib" title="Mi≈Çosz Piechocki">
        </div>
        <div class="dtc db-l v-mid lh-copy measure center f6 black-50 tj">
            Hi! My name is Mi≈Çosz Piechocki. I‚Äôm a software developer living in Warsaw, Poland. I‚Äôm passionate about TypeScript, JavaScript and functional programming in modern web development.
        </div>
        <div class="mt3">
          <a class="twitter-follow-button" data-show-count="false" href="https://twitter.com/miloszpp">
            Follow me on Twitter</a>
        </div>
    </article>
</div>

<hr class="dn-l mw4 black-50 mt5">

<div class="mt5 tc tl-l">
  <h3>Download free e-book</h3>
  <a href="http://typescriptmasterclass.com/10tips" target="_blank"><img src="/images/10tips.png"></a>
</div>

<div class="mt5 tc tl-l">
  <h3>Buy my book</h3>
  <a href="http://typescriptmasterclass.com" target="_blank"><img src="/images/AdvancedTypeScript.jpg"></a>
</div>

<hr class="dn-l mw4 black-50 mt5">

                </div>
            </div>
        </div>
    </div>
</div>


<!-- Footer -->
<div class="bg-1 ph2 ph5-ns pv5">
    <div class="mv8">
        <div class="center tc">
            
                <div class="dib mh3">
                    <a class="f3 f2-ns white dim" href="http://twitter.com/miloszpp/" target="_blank">
                        <i class="fab fa-twitter"></i>
                    </a>
                </div>
            
                <div class="dib mh3">
                    <a class="f3 f2-ns white dim" href="http://facebook.com/codewithstyle.info/" target="_blank">
                        <i class="fab fa-facebook"></i>
                    </a>
                </div>
            
                <div class="dib mh3">
                    <a class="f3 f2-ns white dim" href="https://github.com/miloszpp" target="_blank">
                        <i class="fab fa-github"></i>
                    </a>
                </div>
            
                <div class="dib mh3">
                    <a class="f3 f2-ns white dim" href="https://www.youtube.com/channel/UC_DEBDpgRyBZAT85tJ1QZBw" target="_blank">
                        <i class="fab fa-youtube"></i>
                    </a>
                </div>
            
                <div class="dib mh3">
                    <a class="f3 f2-ns white dim" href="mailto:milosz@miloszpiechocki.com" target="_blank">
                        <i class="fas fa-envelope"></i>
                    </a>
                </div>
            
                <div class="dib mh3">
                    <a class="f3 f2-ns white dim" href="/atom.xml" target="_blank">
                        <i class="fas fa-rss"></i>
                    </a>
                </div>
            
        </div>
        <div class="f6 f5-ns center tc white pt5 fw3">
            @Copyright Mi≈Çosz Piechocki. All right reserved | Design & Hexo based on Anodyne by <a class="link dim white" href="http://www.codeblocq.com/">Jonathan Klughertz</a>
        </div>
    </div>
</div>

  <!-- Load Facebook SDK for JavaScript -->
  <div id="fb-root"></div>
  <script>(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));</script>

<!-- After Footer -->
<!-- Disqus Comments -->

<script type="text/javascript">
    var disqus_shortname = 'codewithstyle';

    (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



</body>

</html>